\begin{frame}{F 最小环 {by \itshape Itst}}

	求一个 $n$ 个点、$m$ 条边、边带正整数权值的弱联通图的最小环.

	$n\le 3\times 10^5, m-n\le 1500$.

\end{frame}

\begin{frame}{题解}

	注意到当一个节点的入度或出度为 \texttt{0} 时，这个点一定不会出现在最小环内，我们可以把这样的点删掉.

	同时，如果一个节点 $v$ 的入度和出度都恰好为 \texttt{1}，那么我们可以直接把 $u\rightarrow v$ 和 $v\rightarrow w$ 缩成一条边 $u\rightarrow w$，边权为原本的两条边权和. 由于经过 $v$ 必然会走 $u\rightarrow v\rightarrow w$，这样不会改变最小环的存在性和长度.

	注意到这样做完之后每个节点的入度和出度的和至少为三，而每条边只贡献一个入度和一个出度，因此设最终得到的图的点数为 $n'$，边数为 $m'$，我们有 $2m'\ge 3n'$.

	又由于图弱联通，我们每次做以上操作删除一个点时都至少删除了一条边. 因此 $m'-n'\le 1500$，得到 $n'\le 3000, m'\le 4500$.

	因此我们在最终得到的图上枚举每个节点跑一遍最短路并更新最小环答案，复杂度为 $O(n'm'\log {m'})$.

\end{frame}
