\begin{frame}{H 哈密顿 {by \itshape Itst}}
	给出 $n$ 个二元组 $(a_i,b_i)$.

	考虑 $n$ 个节点的带权有向完全图 $G$，其中 $i\rightarrow j$ 边权为 $|a_i-b_j|$.

	求 $G$ 的一条哈密顿回路使得其经过的边的边权和最大，并给出这个最大值.

	$n\le 10^5, a_i,b_i\le 10^9$.

\end{frame}

\begin{frame}{题解}
	
	我们需要一些绝对值的和最大. \pause

	由于 $|a_i-b_j|=\max(a_i-b_j,b_j-a_i)$，我们可以在找哈密顿回路的基础上，要求给每个 $a_i$ 和 $b_j$ 一个正负号，使得每条 $i\rightarrow j$ 的边上的 $a_i$ 和 $b_j$ 一正一负，并要求按照符号加权的和尽可能大. 这个最大值就是我们想求的原问题的最大值. \pause

	由于哈密顿路上每个点入度和出度都是 \texttt{1}，所以最终这个标符号的方案就是在 $2n$ 个元素中 $n$ 个正 $n$ 个负. 因此我们实际上需要求的是一个给 $2n$ 个元素 $n$ 个正 $n$ 个负的方案，使得和尽可能大，且能够找到一条回路满足上面的条件（$a_i$ 和 $b-j$ 一正一负）. \pause

	如果我们扔掉回路的限制，那么这个最大的和的方案是简单的: 按照大小排序，取较大的 $n$ 个为正、较小的 $n$ 个为负. 但这样可能不存在哈密顿回路，我们需要仔细考虑这个哈密顿回路的条件.

\end{frame}

\begin{frame}{题解}

	考察怎样的正负号标记会违背回路的限制. \pause

	注意到回路的连边需要要求 $a_i$ 中标为负（正）的必须和 $b_j$ 中标为正（负）的连边. 那么如果所有 $b_i$ 为负的 $i$ 对应 $a_i$ 都为正，那么由于 $b_i$ 为负、$a_i$ 为正的 $i$ 必然不能和 $b_j$ 为正、$a_j$ 为负的 $j$ 连边，那么当两种情况都存在的时候就没法连成大环. \pause

	而如果只存在一种情况，或者存在 $a_i,b_i$ 都为正的 $i$，那么可以通过这样的 $i$ 把两个部分连接在一起，从而可以构造出哈密顿回路. \pause

	因此不存在哈密顿回路的条件为: \pause
	\begin{itemize}
	\item 存在 $b_i$ 为负、$a_i$ 为正的 $i$ 以及 $b_j$ 为正、$a_j$ 为负的 $j$; \pause
	\item 不存在 $a_k,b_k$ 均为正的 $k$;
	\end{itemize}

\end{frame}

\begin{frame}{题解}
	
	由于初始的贪心解可能不满足限制，我们考虑用尽可能小的调整得到满足限制的解. \pause

	首先想到的贪心调整为交换排名为 $n$ 和 $n+1$ 的两个元素的符号，但这样依然可能不满足限制. 但如果这样不满足限制的话，排名为 $n$ 和 $n+1$ 的两个元素就是某个二元组 $(a_i,b_i)$ 了. 因此进一步的调整——交换 $n$ 和 $n+2$ 或者 $n-1$ 和 $n+1$ 的符号，就都会得到合法的方案. \pause

	比较所有四种方案的合法性并取符合条件的方案中的最优解即可. \pause

	复杂度 $O(n\log n)$.


\end{frame}
